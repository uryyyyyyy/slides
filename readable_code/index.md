
## はじめに

システムが扱う内容が複雑なものや、製品の寿命が長いものは、どうしてもコードも複雑になってしまうでしょう。
職場によっては、「まぁ仕方ないよね」なんて声も聞こえてくるかもしれません。

しかし、元々が複雑なコードでも原則をしっかり守れば、読めなくなることはないはずです。

ということで、まずはここで紹介するコードを汚さの基準値として持っておいて、
それ以上汚くなったら「もっと綺麗にしなきゃ」と心がけるようになれば上出来だと思います。

個別のテクニックよりも、そういった視点で自分のコードを見れるかが重要でしょう。


### こんなのやっても意味ないよ

綺麗なコードを書こう、というとこんな声が上がってきます。

- 費用対効果はどうなの？
- 頑張っても評価されないよね？
- そんなことより作りたい新機能があってさ

たしかに、短期的には損かもしれません。
しかし、いかにわかりやすく分割するか、無駄を省くかという知的作業を続けることで、
物事を抽象化して捉え、自身の思考プロセスを整理することに役立つと思います。

これらは、業務ドメインや言語を超えて通用するスキルだと思います。



### 理解しやすいコード。
読みやすさの基本定理は、他人が理解できること。数か月後の自分でもいい。
（その場限り、絶対変更しないコード以外は、誰かが見ることになる。そういったコードには読みやすさは必須）

```java
return exponent >= 0 ? mantissa * (1 << exponent) : mantissa / (1 << -exponent) ;

if (exponent >= 0) { 
return mantissa * (1 < < exponent); 
} else { 
return mantissa / (1 << -exponent);

}
```

どちらが理解しやすいか



俺って頭良い！って複雑なメソッドは書くな。誰でも理解できるレベルに落としこむことが本当は大事。



### 名前に情報を盛り込む

Javaの場合は特に重要。長い名前でもIDEが変換してくれるし、コンパイルされるときには適切なByteになる。（JavaScriptはまた事情が違う。）



10p



最善の名前は誤解されないこと。





### コードの再構成。

一度に一つのことだけ行う。

そのために必要だが処理には無関係なことは下位においやる。

最初に言葉で説明する。説明が難しいようなら、おそらく複数のことをやろうとしている。



実際にコードを見て、わかりにくいなと感じる、あちこちをいじってると感じるなら分解できる。

p131改善。

将来的に再利用できそうな気がするでしょ？



実装はいいから、まずは処理に名前を付けて行くことを意識する。

例えばデータの照会

入力を確認する

  入力が適切か確認する。

  入力されたデータを適切な形にする。

  処理系へ渡す。

計算する

  送られてきたデータを確認する。

  適切なDBへアクセスする。

  取得結果を計算する

  出力系へ渡す。

出力する。

  処理系のデータを受け取る。

  適切な出力形式を探す。

  データを出力形式に適合させる。

  画面に表示する。



もし、何々して何々する、と書いていたら、たぶん複数のことをやってる。



リクエストからユーザーを抽出して計算してから出力する。

登録された時間に応じて給与を算出してDBに保存する。



152p

これより来たないコードあったら教えて下さい。たくさんあるらしいので。



ラバーダッキングすることで明確な形になる。





そんなに難しく考えなくてもいい。

たとえば、店舗検索システムで、ユーザーから近いところを探すロジックを厳密に書くと、

北極や難局に近い時の井戸軽度の計算。

高度と歩きやすさを考慮した計算。

なとが必要になるだろう。でも国内だけならそんなのはいらない。



なるべく単純にすることだ。1%の例外に時間をかけるよりも他の実装をする方が良い。





